!function(t,e){"use strict";if("undefined"!=typeof module&&module.exports)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else if("object"==typeof angular&&"function"==typeof angular.module){var n=e();angular.module("lemoncase",[]).provider("LC",function(){this.setup=n.setup,this.$get=[function(){return n}]})}else window.LC=e()}(this,function(){"use strict";function t(t,e){var n=o.contextFrame;n.style.height="100%",n.style.width="100%",t.appendChild(n),(e||r.noop).call(n)}function e(t){return this instanceof e?(this.$options={},this.$$buffer=[],this.$assignment=[],this.$field=[],this.field(t.field),void this.assignment(t.assignment)):new e(t)}function n(t,e,n,i){var s={process:{},config:{}},o=[];return r.forEach(t.DATA_KEYS,function(t,e){t&&o.push(e)}),r.forEach(t.DICTIONARY_KEYS,function(t,e){if(!n.isFieldDefined(e))throw new Error("The field: "+e+" is undefined in dictionary.")}),r.forEach(t.OBJECT_KEYS,function(t,n){if(!e.hasOwnProperty(n))throw new Error("The key: "+n+" is undefined in object.")}),r.forEach(t.PROCESSES,function(t,e){var n=s.process[e]=[];r.forEach(t.BODY.segment,function(t){n.push(c(t.TYPE).$new(t,i))})}),s.config.times=t.CONFIG.times,s.config.interval=t.CONFIG.interval,s.config.screen=t.CONFIG.screen,{eT:s,dK:o}}function i(t,e,o){if(!(this instanceof i))return new i(t);var a=n(t,e,o,this);this.$$executionTree=a.eT,this.$dictionary=o,this.$objectList=e,this.$$log=new s(a.dK),this.$$state="ready",this.$$coreId=null,this.$$activeTime=0,this.$$currentLoop=0,this.$$blockStack=[],this.$$scopeStack=[],this.$$instructionBuffer=void 0,this.$$tempInstruction=void 0,this.$$idleTask=r.noop,this.$loopData=null}!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.LP=t()}}(function(){return function t(e,n,i){function s(o,a){if(!n[o]){if(!e[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=n[o]={exports:{}};e[o][0].call(u.exports,function(t){var n=e[o][1][t];return s(n?n:t)},u,u.exports,t,e,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(t,e,n){var i=t("./tokentype.js").types;e.exports=function(t){var e=t.prototype;e.parseExpression=function(){var t=this.parseMaybeAssign();if(this.type===i.comma){var e={type:"SequenceExpr"};for(e.expressions=[t];this.eat(i.comma);){var n=this.parseMaybeAssign();e.expressions.push(n)}return e}return t},e.parseMaybeAssign=function(){var t=this.parseMaybeConditional();if(this.type.isAssign){var e={type:"AssignmentExpr",left:t,operator:this.value};return this.next(),e.right=this.parseMaybeAssign(),e}return t},e.parseMaybeConditional=function(){return this.parseExprOps()},e.parseExprOps=function(){var t=this.start,e=this.parseMaybeUnary(!1);return this.parseExprOp(e,t,-1)},e.parseExprOp=function(t,e,n){var i=this.type.binop;if(null!=i&&i>n){var s=this.type,r=this.value;this.next();var o=this.start,a=this.parseExprOp(this.parseMaybeUnary(!1),o,i),c=this.buildBinary(e,t,a,r,s);return this.parseExprOp(c,e,n)}return t},e.buildBinary=function(t,e,n,s,r){var o={left:e,operator:s,right:n};return r===i.logicalAND||r===i.logicalOR?o.type="LogicalExpr":r===i.match?o.type="MatchExpr":o.type="BinaryExpr",o},e.parseMaybeUnary=function(t){var e;if(this.type.prefix){var n={},s=this.type===i.incDec;n.operator=this.value,n.prefix=!0,this.next(),n.argument=this.parseMaybeUnary(!1),s||(t=!0),n.type=s?"UpdateExpr":"UnaryExpr",e=n}else for(e=this.parseExprSubscripts();this.type.postfix;){var r={};r.operator=this.value,r.prefix=!1,r.argument=e,this.next(),r.type="UpdateExpr",e=r}return e},e.parseExprSubscripts=function(){var t=this.start,e=this.parseExprAtom();return this.parseSubscripts(e,t)},e.parseSubscripts=function(t,e){for(;;){if(this.eat(i.parenL)){var n={type:"CallExpr",callee:t};return this.expect(i.parenR),n}return t}},e.parseExprAtom=function(){var t;switch(this.type){case i.name:var e=this.parseIndent(this.type!==i.name);return{type:"Identifier",name:e};case i.regexp:var n=this.value;return t=this.parseLiteral("regexp"),t.regexp=n,t;case i.num:case i.string:return this.parseLiteral("literal",this.value);case i.objectAt:case i.dict:return this.parseExtLiteral(this.type);case i.parenL:return this.parseParenExpression();case i.tagAtL:case i.tagNumL:return this.parseTagExpression();default:this.unexpected()}},e.parseLiteral=function(t,e){var n={type:t,value:e,raw:this.input.slice(this.start,this.end)};return this.next(),n},e.parseExtLiteral=function(t){var e={type:t.label,value:this.value};return this.next(),e},e.parseParenExpression=function(){this.expect(i.parenL);var t=this.parseExpression();return this.expect(i.parenR),{type:"ParenthesizedExpr",expression:t}},e.parseTagExpression=function(){var t={type:this.type===i.tagAtL?"TextExpr":"CountExpr"};return this.next(),t.val=this.parseExpression(),this.expect(i.tagR),t},e.parseIndent=function(){var t;return this.type===i.name?t=this.value:this.unexpected(),this.next(),t}}},{"./tokentype.js":12}],2:[function(t,e,n){function i(t){return 65>t?36===t:91>t?!0:97>t?95===t:123>t}function s(t){return 48>t?36===t:58>t?!0:65>t?!1:91>t?!0:97>t?95===t:123>t}var r=["in","by"],o=["click","input","rclick","dblclick","movein","moveout","scroll","select","jumpto","refresh"],a=["#CLOCK","#TIMES","#INTERVAL","#SCREEN"],c=["wait","assert","log","console","var","process","return"].concat(r).concat(o).concat(a),h=new RegExp("^("+c.join("|")+")$");e.exports={keywordRegexp:h,isIdentifierStart:i,isIdentifierChar:s}},{}],3:[function(t,e,n){var i=t("./state.js");e.exports={parse:function(t,e){return new i(e,t).parse()},tokenizer:function(t,e){return new i(e,t)}}},{"./state.js":9}],4:[function(t,e,n){var i=t("./locutil.js").getLineInfo,s=t("./locutil.js").empowerErrMsg;e.exports=function(t){var e=t.prototype;e.raise=function(t,e){var n=i(this.input,t);e+=" ("+n.line+":"+n.column+")",e=s(this.input,n,e);var r=new SyntaxError(e);throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r}}},{"./locutil.js":5}],5:[function(t,e,n){function i(t,e){for(var n=1,i=0;;){c.lastIndex=i;var s=c.exec(t);if(!(s&&s.index<e))return new h(n,e-i);++n,i=s.index+s[0].length}}function s(t,e,n){var i=t.split(c)[e.line-1],s=i.substr(0,e.column),h=a(s),u=r(h),p=o(n,h);return"\n"+i+"\n"+u+"\n"+p}function r(t){for(var e=-1,n=-1,i="";++e<t;)i+=" ";for(i+="↑\n";++n<t;)i+=" ";return i+="↑"}function o(t,e){if(t.length/2>e)return t;for(var n=-1,i=e-Math.floor(t.length/2),s="";++n<i;)s+=" ";return s+=t}function a(t){for(var e,n=0,i=-1,s=t.length;++i<s;)switch(e=t.charCodeAt(i)){case 9:n+=4;break;default:n+=1}return n}var c=t("./whitespace.js").lineBreakG,h=function(t,e){this.line=t,this.column=e};h.prototype.offset=function(t){return new h(this.line,this.column+t)},e.exports={getLineInfo:i,empowerErrMsg:s}},{"./whitespace.js":15}],6:[function(t,e,n){var i=t("./tokentype.js").types;e.exports=function(t){var e=t.prototype;e.parseBindingList=function(t,e,n){for(var s=[],r=!0;!this.eat(t);)if(r?r=!1:this.expect(i.comma),e&&this.type===i.comma)s.push(null);else{if(n)break;var o=this.parseIndent();s.push(o)}return s}}},{"./tokentype.js":12}],7:[function(t,e,n){function i(t){var e={};for(var n in r)e[n]=t&&s(t,n)?t[n]:r[n];return e}var s=t("./util.js").has,r={insertReturn:!0,onComment:function(){},plugins:{}};e.exports={defaultOptions:r,getOptions:i}},{"./util.js":13}],8:[function(t,e,n){var i=t("./tokentype.js").types;e.exports=function(t){var e=t.prototype;e.eat=function(t){return this.type===t?(this.next(),!0):!1},e.semicolon=function(){this.eat(i.semi)||this.expected(i.semi)},e.expect=function(t){this.eat(t)||this.expected(t)},e.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},e.expected=function(t){this.raise(this.lastTokEnd,'Expect a "'+t.label+'" after')},e.UID=function(t){return t+this.nextID++}}},{"./tokentype.js":12}],9:[function(t,e,n){var i=t("./options.js").getOptions,s=t("./identifier.js").keywordRegexp,r=t("./tokentype.js").types,o=function(t,e){this.options=i(t),this.keywords=s,this.input=String(e),this.pos=0,this.type=r.eof,this.value=null,this.start=this.end=this.pos,this.lastTokStart=this.lastTokEnd=this.pos,this.exprAllowed=!1,this.labels=[],this.conf={},this.keys={},this.nextID=0,this.pcs={},this.pcsTable={},this.dTable={},this.obTable={}};o.prototype.parse=function(){this.nextToken();var t={CONFIG:this.conf,DATA_KEYS:this.keys,PROCESSES:this.pcs,DICTIONARY_KEYS:this.dTable,OBJECT_KEYS:this.obTable};return this.parseTopLevel(t)};var a=function(t){t(o)};a(t("./location.js")),a(t("./tokenize.js")),a(t("./statement.js")),a(t("./parseutil.js")),a(t("./expression.js")),a(t("./lval.js")),e.exports=o},{"./expression.js":1,"./identifier.js":2,"./location.js":4,"./lval.js":6,"./options.js":7,"./parseutil.js":8,"./statement.js":10,"./tokenize.js":11,"./tokentype.js":12}],10:[function(t,e,n){var i=t("./tokentype.js").types,s=(t("./whitespace.js").lineBreak,t("./identifier.js").isIdentifierStart,t("./identifier.js").isIdentifierChar,t("./locutil.js").getLineInfo),r=t("./walk.js");e.exports=function(t){var e=t.prototype;e.parseTopLevel=function(t){var e=this.pcsTable;for(e.main={pos:0};this.type!==i.eof;)this.parseStructure();for(var n in e)e[n]&&this.raise(e[n].pos,"Invalid process call at");return t},e.parseStructure=function(){var t=this.type;return t.macro?this.parseSet():t===i._process?this.parseProcess():void this.raise(this.start,"Expect a #set or process")},e.parseSet=function(){var t=this.type;t.macro||this.unexpected();var e=t.label.substr(1).toLowerCase();this.writeConfig(e),this.next()},e.writeConfig=function(t){var e,n=this.conf;switch(n[t]&&this.raise(this.start,this.type.keyword+" was defined already"),t){case"screen":var i,s,r=this.value.split(",");2!==r.length&&this.raise("Invalid arguments"),i=~~parseInt(r[0],10),s=~~parseInt(r[1],10),e={width:i,height:s};break;default:e=parseInt(this.value,10)}n[t]=e},e.parseProcess=function(){var t={LINE:s(this.input,this.start),TYPE:170,BODY:{}},e=this.pcs,n=this.pcsTable;this.next();var i=this.parseIndent();e[i]&&this.raise(this.start,i+" process was defined already"),e[i]=t,n[i]=!1,this.parsePcParam(t),this.parsePcBlock(t)},e.parsePcParam=function(t){this.eat(i.parenL)&&(t.BODY.params=this.parseBindingList(i.parenR,!1,!1))},e.parsePcBlock=function(t){var e=this.parseBlock();e.length&&1===e[e.length-1].TYPE||e.push({LINE:-1,TYPE:1}),t.BODY.segment=e},e.parseBlock=function(){this.expect(i.braceL);for(var t=[];!this.eat(i.braceR);){var e=this.parseStatement(!0);t.push(e)}return t},e.parseStatement=function(t){var e=this.type,n=this.startNode();switch(e){case i._click:case i._rclick:case i._dblclick:case i._movein:case i._moveout:return this.parseMouseAction(n,e.keyword);case i._select:return this.parseSelectAction();case i._scroll:return this.parseScrollAction(n,e.keyword);case i._input:return this.parseInputAction(n,e.keyword);case i._return:return this.parseReturnStatement(n);case i._wait:return this.parseWaitStatement(n);case i._assert:return this.parseAssertStatement(n);case i._log:case i._console:return this.parseLogStatement(n,e===i._log?32:33);case i._jumpto:return this.parseGotoStatement(n);case i._refresh:return this.parseRefreshStatement(n);case i._var:return this.parseVarStatement(n);case i.name:return this.parseExprStatement(n);default:this.unexpected()}},e.parseReturnStatement=function(t){return this.next(),this.eat(i.semi)?t.args=null:this.raise(this.start,"Return expression is not supported"),this.finishNode(t,1)},e.parseVarStatement=function(t){return this.next(),this.parseVar(t),t.BODY.exp=r(t.BODY.raw),this.semicolon(),this.finishNode(t,16)},e.parseVar=function(t){for(var e=[];;){var n={};if(n.id=this.parseIndent(),this.eat(i.eq)?n.init=this.parseMaybeAssign():n.init=null,e.push(n),!this.eat(i.comma))break}t.BODY.raw={declarations:e,type:"varDecl"}},e.parseExprStatement=function(t){var e=this.parseExpression();if(this.semicolon(),"CallExpr"===e.type){var n=e.callee.name;return this.pcsTable[n]!==!1&&(this.pcsTable[n]={pos:this.lastTokStart}),t.BODY.identifier=n,this.finishNode(t,0)}var i=r(e);return t.BODY.raw=e,t.BODY.exp=i,this.finishNode(t,16)},e.parseWaitStatement=function(t){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.delay=r(t.BODY.raw),this.semicolon(),this.finishNode(t,17)},e.parseMouseAction=function(t,e){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.object=r(t.BODY.raw),t.BODY.action=e,this.semicolon(),this.finishNode(t,18)},e.parseScrollAction=function(t,e){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.object=r(t.BODY.raw),this.expect(i._by),t.BODY.raw1=this.parseExpression(),t.BODY.param=r(t.BODY.raw1),t.BODY.action=e,this.finishNode(t,18)},e.parseSelectAction=function(){this.raise("work in progress...")},e.parseInputAction=function(t,e){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.object=r(t.BODY.raw),this.expect(i._by),t.BODY.raw1=this.parseExpression(),t.BODY.param=r(t.BODY.raw1),t.BODY.action=e,this.semicolon(),this.finishNode(t,18)},e.parseAssertStatement=function(t){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.exp=r(t.BODY.raw),this.eat(i._in)&&(this.type===i.num?t.BODY.timeout=this.value:this.unexpected(),this.next()),this.semicolon(),t.BODY.key=this.UID("#"),this.keys[t.BODY.key]=!!t.BODY.timeout,this.finishNode(t,19)},e.parseGotoStatement=function(t){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.url=r(t.BODY.raw),this.semicolon(),this.finishNode(t,20)},e.parseRefreshStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,21)},e.parseLogStatement=function(t,e){return this.next(),t.BODY.raw=this.parseExpression(),t.BODY.msg=r(t.BODY.raw),this.semicolon(),this.finishNode(t,e)},e.startNode=function(){return{LINE:s(this.input,this.start).line,TYPE:0,BODY:{},start:this.start,end:0}},e.finishNode=function(t,e){return t.TYPE=e,t.end=this.lastTokEnd,t}}},{"./identifier.js":2,"./locutil.js":5,"./tokentype.js":12,"./walk.js":14,"./whitespace.js":15}],11:[function(t,e,n){var i=t("./identifier.js").isIdentifierStart,s=t("./identifier.js").isIdentifierChar,r=t("./tokentype.js").types,o=t("./tokentype.js").keywordTypes,a=t("./whitespace.js").isNewLine,c=t("./whitespace.js").lineBreak;e.exports=function(t){var e=t.prototype;e.next=function(){this.lastTokEnd=this.end,this.lastTokStart=this.start,this.nextToken()},e.nextToken=function(){return this.skipSpace(),this.start=this.pos,this.pos>=this.input.length?this.finishToken(r.eof):void this.readToken(this.fullCharCodeAtPos())},e.readToken=function(t){return i(t)||35===t?this.readWord():this.getTokenFromCode(t)},e.fullCharCodeAtPos=function(){return this.input.charCodeAt(this.pos)},e.skipBlockComment=function(){var t=this.pos,e=this.input.indexOf("*/",this.pos+=2);-1===e&&this.raise(this.pos-2,"unterminated comment"),this.pos=e+2,this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,e),t,this.pos)},e.skipLineComment=function(t){for(var e=this.pos,n=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&10!==n&&13!==n&&8232!==n&&8233!==n;)++this.pos,n=this.input.charCodeAt(this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+=t,this.pos),e,this.pos)},e.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos;break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&14>t))break t;++this.pos}}},e.readToken_bracket=function(){var t=this.pos++,e=this.fullCharCodeAtPos();if(i(e)){var n=this.readWord1();return e=this.fullCharCodeAtPos(),93!==e&&this.raise(t,"Unterminated dictionary index"),this.pos++,this.dTable[n]=!0,this.finishToken(r.dict,n)}return this.finishToken(r.bracketL)},e.readToken_brace=function(){var t=this.pos++,e=this.fullCharCodeAtPos();if(i(e)){var n=this.readWord1();return e=this.fullCharCodeAtPos(),125!==e&&this.raise(t,"Unterminated object store index"),this.pos++,this.obTable[n]=!0,this.finishToken(r.objectAt,n)}return this.finishToken(r.braceL)},e.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp("/")):61===t?this.finishOp(r.assign,2):62===t?this.finishOp(r.tagR,2):this.finishOp(r.slash,1)},e.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,i=42===t?r.star:r.modulo;return 61===e?this.finishOp(r.assign,n+1):this.finishOp(i,n)},e.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp("|")):e===t?this.finishOp(124===t?r.logicalOR:r.logicalAND,2):void this.raise(this.pos,"bitwise operator is not allowed")},e.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(r.incDec,2):61===e?this.finishOp(r.assign,2):this.finishOp(r.plusMin,1)},e.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;if(e===t&&this.raise(this.pos,"bitwise operator is not allowed"),60===t){if(35===e)return this.finishOp(r.tagNumL,2);if(64===e)return this.finishOp(r.tagAtL,2)}return 61===e&&(n=2),this.finishOp(r.relational,n)},e.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 126===e&&33===t?this.finishOp(r.match,2):61===e?this.finishOp(r.equality,61===this.input.charCodeAt(this.pos+2)?3:2):this.finishOp(61===t?r.eq:r.prefix,1)},e.getTokenFromCode=function(t){switch(t){case 40:return++this.pos,this.finishToken(r.parenL);case 41:return++this.pos,this.finishToken(r.parenR);case 59:return++this.pos,this.finishToken(r.semi);case 44:return++this.pos,this.finishToken(r.comma);case 91:return this.readToken_bracket();case 93:return++this.pos,this.finishToken(r.bracketR);case 123:return this.readToken_brace();case 125:return++this.pos,this.finishToken(r.braceR);case 58:return++this.pos,this.finishToken(r.colon);case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:var e=this.input.charCodeAt(this.pos+1);return 126!==e&&this.raise(this.pos,"bitwise operator is not allowed"),this.finishOp(r.match,2)}this.raise(this.pos,'Unexpected character "'+this.input[this.pos]+'"')},e.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+=e);return this.finishToken(t,n)},e.finishToken=function(t,e){this.end=this.pos,this.type=t,this.value=e,this.exprAllowed=this.type.beforeExpr},e.readRegexp=function(t){for(var e,n,i=this.pos;;){this.pos>=this.input.length&&this.raise(i,"Unterminated regular expression");var s=this.input.charAt(this.pos);if(c.test(s)&&this.raise(i,"Unterminated regular expression"),e)e=!1;else{if("["===s)n=!0;else if("]"===s&&n)n=!1;else if(s===t&&!n)break;e="\\"===s}++this.pos}var o=this.input.slice(i,this.pos);++this.pos;var a=this.readWord1();if(a){var h=/^[gim]*$/;h.test(a)||this.raise(i,"Invalid regular expression flag")}var u={pattern:o,flags:a,gen:"|"===t};return this.finishToken(r.regexp,u)},e.readInt=function(t,e){for(var n=this.pos,i=0,s=0,r=null==e?1/0:e;r>s;++s){var o,a=this.fullCharCodeAtPos();if(o=a>=97?a-97+10:a>=65?a-65+10:a>=48&&57>=a?a-48:1/0,o>=t)break;++this.pos,i=i*t+o}return this.pos===n||null!=e&&this.pos-n!==e?null:i},e.readNumber=function(t){var e=this.pos,n=!1;t||null!==this.readInt(10)||this.raise(e,"Invalid Number");var s=this.fullCharCodeAtPos();46===s&&(++this.pos,this.readInt(10),n=!0,s=this.fullCharCodeAtPos()),69!==s&&101!==s||(s=this.input.charCodeAt(++this.pos),43!==s&&45!==s||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number"),n=!0),i(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o,a=this.input.slice(e,this.pos);return o=n?parseFloat(a):parseInt(a,10),this.finishToken(r.num,o)},e.readString=function(t){for(var e="",n=this.start,i=++this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated string");var s=this.fullCharCodeAtPos();if(s===t)break;92===s?(e+=this.input.slice(i,this.pos),e+=this.readEscapedChar(),i=this.pos):(a(s)&&this.raise(n,"Unterminated string"),++this.pos)}return e+=this.input.slice(i,this.pos++),this.finishToken(r.string,e)},e.readEscapedChar=function(){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return"\n";case 114:return"\r";case 116:return"	";case 98:return"\b";case 118:return"\x0B";case 102:return"\f";case 13:10===this.fullCharCodeAtPos()&&++this.pos;case 10:return"";default:return String.fromCharCode(t)}},e.readWord1=function(){for(var t="",e=!0,n=this.pos;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(s(i))++this.pos;else{if(!e||35!==i)break;++this.pos}e=!1}return t+=this.input.slice(n,this.pos)},e.readWord=function(){var t,e=this.pos,n=this.readWord1();if(this.keywords.test(n)){if(t=o[n],t.macro){var i=this.readMacro();return this.finishToken(t,i)}}else 35===n.charCodeAt(0)&&this.raise(e,"# is only valid for # macro"),t=r.name;return this.finishToken(t,n)},e.readMacro=function(){for(var t=this.pos,e=this.fullCharCodeAtPos();this.pos<this.input.length&&10!==e&&13!==e&&8232!==e&&8233!==e;)++this.pos,e=this.input.charCodeAt(this.pos);return this.input.slice(t,this.pos).trim()}}},{"./identifier.js":2,"./tokentype.js":12,"./whitespace.js":15}],12:[function(t,e,n){function i(t,e){return new r(t,{beforeExpr:!0,binop:e})}function s(t,e){e=e||{},e.keyword=t,h[t]=c["_"+t]=new r(t,e)}var r=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.macro=!!e.macro},o={beforeExpr:!0},a={macro:!0},c={num:new r("num"),regexp:new r("regexp"),string:new r("string"),name:new r("name"),eof:new r("eof"),objectAt:new r("objectStore"),dict:new r("dictionaryIndex"),bracketL:new r("[",o),bracketR:new r("]"),braceL:new r("{",o),braceR:new r("}"),parenL:new r("(",o),parenR:new r(")"),comma:new r(",",o),semi:new r(";",o),colon:new r(":",o),tagNumL:new r("<#",o),tagAtL:new r("<@",o),tagR:new r("/>"),eq:new r("=",{beforeExpr:!0,isAssign:!0}),assign:new r("_=",{beforeExpr:!0,isAssign:!0}),incDec:new r("++/--",{prefix:!0,postfix:!0}),prefix:new r("prefix",{beforeExpr:!0,prefix:!0}),logicalOR:i("||",1),logicalAND:i("&&",2),equality:i("==/!=",6),relational:i("</>",7),plusMin:new r("+/-",{beforeExpr:!0,binop:9,prefix:!0}),modulo:i("%",10),star:i("*",10),slash:i("/",10),match:i("~~",6)},h={};s("in"),s("by",o),s("click",o),s("input",o),s("rclick",o),s("dblclick",o),s("movein",o),s("moveout",o),s("scroll",o),s("select",o),s("#CLOCK",a),s("#TIMES",a),s("#INTERVAL",a),s("#SCREEN",a),s("wait",o),s("assert",o),s("log",o),s("console",o),s("var"),s("process"),s("return",o),s("jumpto"),s("refresh"),e.exports={TokenType:r,types:c,keywordTypes:h}},{}],13:[function(t,e,n){function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports={isArray:i,has:s}},{}],14:[function(t,e,n){var i={varDecl:function(t,e){var n="",i=!0;return t.declarations.forEach(function(t){t.init&&(i||(n+=","),n+="$."+t.id+" = "+e(t.init),i=!1)}),"("+n+")"},SequenceExpr:function(t,e){var n="",i=!0;return t.expressions.forEach(function(t){i||(n+=","),n+=e(t),i=!1}),"("+n+")"},literal:function(t,e){return t.raw},regexp:function(t,e){if(t.regexp.gen){var n=t.regexp;return"(/"+n.pattern+"/"+n.flags+").gen()"}return"("+t.raw+")"},dictionaryIndex:function(t,e){return"d."+t.value},objectStore:function(t,e){return"o."+t.value},Identifier:function(t,e){return"$."+t.name},LogicalExpr:function(t,e){return e(t.left)+t.operator+e(t.right)},BinaryExpr:function(t,e){return e(t.left)+t.operator+e(t.right)},MatchExpr:function(t,e){var n="";return"~~"===t.operator&&(n+="!"),n+"!("+e(t.left)+").match("+e(t.right)+").length"},UpdateExpr:function(t,e){var n="$."+t.argument;return t.prefix?t.operator+n:n+t.operator},UnaryExpr:function(t,e){return t.operator+"("+e(t.argument)+")"},AssignmentExpr:function(t,e){return e(t.left)+t.operator+e(t.right)},ParenthesizedExpr:function(t,e){return"("+e(t.expression)+")"},TextExpr:function(t,e){var n="String("+e(t.val)+")";return"t("+n+")"},CountExpr:function(t,e){var n="String("+e(t.val)+")";return"c("+n+")"}};e.exports=function(t){var e=function n(t){var e=t.type;return i[e](t,n)}(t);return new Function("$,o,d,c,t","return "+e+";")}},{}],15:[function(t,e,n){var i=/\r\n?|\n|\u2028|\u2029/;e.exports={lineBreak:i,lineBreakG:new RegExp(i.source,"g"),isNewLine:function(t){return 10===t||13===t||8232===t||8233==t}}},{}]},{},[3])(3)}),function(){function t(t,e,n){var i,s=[t];for(i in n)n.hasOwnProperty(i)&&(s[n[i]]=e[i]||null);return s}function e(t){return 1===t.nodeType}function n(t){return t instanceof Window}function i(t){return null!==t&&"object"==typeof t}function s(t){return"function"==typeof t}function r(t,e){e?t.$$hashKey=e:delete t.$$hashKey}function o(t,e){var n,o,a,c,h,u,p,f,l=t.$$hashKey;if(e)for(o=0,n=e.length;n>o;++o)if(p=e[o],i(p)||s(p))for(f=Object.keys(p),c=0,a=f.length;a>c;c++)h=f[c],u=p[h],t[h]=u;return r(t,l),t}function a(t){return o(t,[].slice.call(arguments,1),!1)}function c(t,e,n){d&&t.dispatchEvent(new $(e,a({},A,n)))}function h(t,e,n){t.dispatchEvent(new b(e,a({},A,n)))}function u(t,e,n){t.dispatchEvent(new w(e,a({},A,n)))}function p(t){this.element=t,this.action=this.getActionRule(t)}var f,l=!0,d=!0,v=!0;try{f=new MouseEvent("click",{})}catch(m){l=!1}try{TouchEvent}catch(g){d=!1}try{InputEvent}catch(y){v=!1}var $,x=l&&!d?Event:function(e,n){var i=document.createEvent("Event"),s={bubbles:1,cancelBubble:2};return i.initEvent.apply(i,t(e,n,s)),i},b=l&&!d?MouseEvent:function(e,n){var i=document.createEvent("MouseEvent"),s={bubbles:1,cancelBubble:2,view:3,detail:4,screenX:5,screenY:6,clientX:7,clientY:8,ctrlKey:9,altKey:10,shiftKey:11,metaKey:12,button:13,relatedTarget:14};return i.initMouseEvent.apply(i,t(e,n,s)),i},k=l&&!d?UIEvent:function(e,n){var i=document.createEvent("UIEvent"),s={bubbles:1,cancelBubble:2,view:3,detail:4};return i.initUIEvent.apply(i,t(e,n,s)),i},w=l&&!d?KeyboardEvent:function(e,n){var i=document.createEvent("KeyboardEvent"),s={bubbles:1,cancelBubble:2,view:3,"char":4,key:5,location:6,repeat:8};return i.initKeyboardEvent.apply(i,t(e,n,s)),i};v?InputEvent:k;d&&!l&&($=function(e,n){var i=document.createEvent("TouchEvent"),s={bubbles:1,cancelBubble:2,view:3,detail:4};return i.initUIEvent.apply(i,t(e,n,s)),i});var E,C,T={contextIframe:null,window:function(){return T.contextIframe?T.contextIframe.contentWindow:window}},S=[],A={bubbles:!0,cancelBubble:!0},O=0,I=1,L=2,D=3,B=4,j=5,N=6,_=7,Y=8,R=9,P=16,M=17,F=18,U=32,K=33,W=34,q=36,G=48,H=49;S[O]=function(t){c(this,"touchend",t),h(this,"mouseup",t)},S[I]=function(t){c(this,"touchstart",t),h(this,"mousedown",t)},S[L]=function(t){h(this,"mouseenter",t)},S[D]=function(t){h(this,"mouseleave",t)},S[B]=function(t){h(this,"mouseout",t)},S[j]=function(t){h(this,"mouseover",t)},S[N]=function(t){c(this,"touchmove",t),h(this,"mousemove",t)},S[_]=function(t){h(this,"click",t)},S[Y]=function(t){h(this,"dblclick",t)},S[R]=function(t){h(this,"contextmenu",t)},S[M]=function(t){u(this,"keydown",t)},S[F]=function(t){u(this,"keypress",t)},S[P]=function(t){u(this,"keyup",t)},S[W]=function(){this.focus()},S[K]=function(t){var e=T.contextIframe.style;e.width=t.width+"px",e.height=t.height+"px"},S[U]=function(t){T.window().scrollTo(t.x,t.y),this.dispatchEvent(new k("scroll"))},S[q]=function(t){var e=this[t.index];S[I].call(e,t),S[O].call(e,t),e.selected=!0,this.dispatchEvent(new k("select")),S[_].call(e,t),S[B].call(e,t)},S[G]=function(t){this.value=t.value,this.dispatchEvent(new k("input",t))},S[H]=function(){this.dispatchEvent(new x("change",{bubbles:!0}))},p.prototype.getActionRule=function(t){return t=t||this.element,t instanceof Window?C.window:"input"===t.tagName.toLowerCase()?C["input/"+t.type]:"textarea"===t.tagName.toLowerCase()?C.textarea:"select"===t.tagName.toLowerCase()?C.select:C.generic},p.prototype.does=function(t,e){var n,i,s;if(this.testAction(t)!==!0)throw"The element:"+this.element.outerHTNL+" can not use action:"+t;for(s=this.action[t],i=s.length,n=0;i>n;n+=1)S[s[n]].call(this.element,e||{});return this},p.prototype.testAction=function(t){return this.action.hasOwnProperty(t)},C=function(){var t={};return t["input/checkbox"]=t["input/radio"]=t["input/button"]=t.generic={click:[I,N,O,_],dblclick:[I,O,_,I,O,_,Y],rclick:[I,O,R],movein:[j,B],moveout:[N,B],scroll:[U]},t.textarea=t["input/text"]=t["input/password"]=t["input/email"]=a({},t.generic,{input:[W,M,F,G,P,H],click:[I,W,N,O,_],dblclick:[I,W,N,O,_,I,N,O,_,Y],rclick:[I,W,O,R]}),t.select=a({},t.generic,{select:[I,W,N,O,_,N,B,q]}),t.window={scroll:[U],resize:[K]},t}(),E=function(t){if(!n(t)&&!e(t))throw'"element" for trigger must be a HTMLElement';return new p(t)},E.setupIframe=function(t){if(!(t instanceof HTMLIFrameElement))throw'"element" must be a iframe element.';T.contextIframe=t},window.trigger=E}();var s=function(t){this.$$baseTime=0,this.$dataKeys=t||[],this.$marks=[],this.$logs=[],this.$datas={}};s.prototype.initialization=function(){return this.clear(),this.$$baseTime=r.now(),r.forEach(this.$dataKeys,function(t){this[t]=[]},this.$datas),this},s.prototype.getLength=function(t){return this["$"+t].length},s.prototype.log=function(t,e){return this.$logs.push([t,r.now()-this.$$baseTime,e||0]),this},s.prototype.data=function(t,e){return this.$datas[t].push(e),this},s.prototype.markLog=function(t,e){return this.$marks.push([t,e,this.getLength("logs")-1]),this},s.prototype.clear=function(){return this.$$baseTime=0,this.$marks.length=0,this.$logs.length=0,this.$datas={},this},s.prototype.export2json=function(){return{baseTime:this.$$baseTime,marks:this.$marks,logs:this.$logs,performance:this.$datas}},s.prototype.export2text=function(){return JSON.stringify(this.export2json())},function(){var t={POSITION:0,CLASS:2,RANGE:3,CLAUSE:6,REFERENCE:7,INTS:"0123456789",WORDS:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",WHITESPACE:" \f\n\r	\x0B  ᠎           \u2028\u2029\u2028\u2029  　"},e="@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^ ?",n={0:0,t:9,n:10,v:11,f:12,r:13},i={rndChar:function(t){return t[Math.floor(Math.random()*t.length)]},anyRndChar:function(){return String.fromCharCode(i.rndInt(0,65535))},strToChars:function(t){var i=/\\(?:u([A-F0-9]{4})|x([A-F0-9]{2})|(0?[0-7]{2})|c([@A-Z\[\\\]^?])|([0tnvfr]))/g;return t=t.replace(i,function(t,i,s,r,o,a){var c,h=i?parseInt(i,16):s?parseInt(s,16):r?parseInt(r,8):o?e.indexOf(o):a?n[a]:void 0;return void 0!==h?(c=String.fromCharCode(h),c=c.replace(/[[\]{}^$.|?*+()]/g,function(t){return"\\"+t})):c="\\"+a,c})},rndInt:function(t,e){return t+Math.floor(Math.random()*(1+e-t))},findChar:function(t){for(var e="\\",n="]",i=0;;){var s=t.indexOf(n);if(t[s-1]!==e)return i+s;t=t.slice(++s),i+=s}},range:function(e,n,i){var s=t.WORDS;return s.slice(s.indexOf(n),s.indexOf(i)+1)},classRange:function(t){return t.replace(/(\w)-(\w)/g,i.range)},toBothCases:function(t){var e=t;return e+=t["to"+(t===t.toLowerCase()?"Upper":"Lower")+"Case"]()},inCaseClass:function(t,e){return e?t=t.replace(/[a-zA-Z]/g,function(t){return i.toBothCases(t)}):t},inCaseChar:function(e,n){return n&&/[a-zA-Z]/.test(e)?{type:t.CLASS,chars:i.toBothCases(e)}:e},flatten:function(t){
for(var e=0;e<t.length-1;e++)if("string"==typeof t[e])for(var n=e+1;;){var i=t[n];if("string"!=typeof i)break;t[e]+=i,t.splice(n,1)}return 1===t.length?t[0]:t},reduce:function(t){if(t.stack)t.stack=i.flatten(t.stack);else if(t.options)for(var e=0,n=t.options.length;n>e;e++)t.options[e]=i.flatten(t.options[e]);return t.options||t.group||t.value?t:t.stack},nextClose:function(t){for(var e=0,n=0,i=t.length;i>n;n++){var s=t[n];switch(s){case")":if(0===e)return n+1;e--;break;case"(":e++;break;case"\\":n++}}}},s={type:t.POSITION,value:"b"},r={type:t.POSITION,value:"B"},o={type:t.POSITION,value:"^"},a={type:t.POSITION,value:"$"},c={type:t.CLASS,chars:t.WORDS},h={type:t.CLASS,chars:t.WORDS,not:!0},u={type:t.CLASS,chars:t.INTS},p={type:t.CLASS,chars:t.INTS,not:!0},f={type:t.CLASS,chars:t.WHITESPACE},l={type:t.CLASS,chars:t.WHITESPACE,not:!0},d={type:t.CLASS,chars:"\n",not:!0},v=function(e,n,v){var m,g=0,y={type:t.CLAUSE,stack:[]},$=y,x=y.stack,b=[];for(e=i.strToChars(e);g<e.length;)switch(m=e[g++]){case"\\":switch(m=e[g++]){case"b":x.push(s);break;case"B":x.push(r);break;case"w":x.push(c);break;case"W":x.push(h);break;case"d":x.push(u);break;case"D":x.push(p);break;case"s":x.push(f);break;case"S":x.push(l);break;default:/\d/.test(m)?x.push({type:t.REFERENCE,value:parseInt(m)}):x.push(m)}break;case"^":x.push(o);break;case"$":x.push(a);break;case"[":if(m=e[g],"\\"===m&&0===e.slice(g+1).indexOf("b]"))g+=3,x.push("\b");else{var k;"^"===m?(k=!0,g++):k=!1;var w=e.slice(g),E=i.findChar(w),C=w.substring(0,E);g+=E+1,x.push({type:t.CLASS,chars:i.inCaseClass(i.classRange(C),n),not:k})}break;case".":x.push(d);break;case"(":m=e[g];var T;if("?"===m){if(m=e[g+1],g+=2,"!"===m){g+=i.nextClose(e.slice(g));break}T=!1}else T=!0;var S={type:t.CLAUSE,group:T,stack:[]};x.push(S),b.push($),$=S,x=S.stack;break;case")":$=b.pop(),x=$.options?$.options[$.options.length-1]:$.stack;var A=x.length-1;x[A]=i.reduce(x[A]);break;case"|":$.options||($.options=[$.stack],delete $.stack);var O=[];$.options.push(O),x=O;break;case"{":var I=/^(\d+)(,(\d+)?)?\}/.exec(e.slice(g)),L=parseInt(I[1]),D=I[2]?I[3]?parseInt(I[3]):1/0:L;g+=I[0].length;var B=x.pop();if(L===D)for(var j=0;L>j;j++)x.push(B);else x.push({type:t.RANGE,min:L,max:D,value:B});break;case"?":var B=x.pop();x.push({type:t.RANGE,min:0,max:1,value:B});break;case"+":var B=x.pop();x.push({type:t.RANGE,min:1,max:1/0,value:B});break;case"*":var B=x.pop();x.push({type:t.RANGE,min:0,max:1/0,value:B});break;default:x.push(i.inCaseChar(m,n))}return i.reduce(y)},m=function(e,n,s,r){if("string"==typeof e)return e;if(e.length){for(var o="",a=0,c=e.length;c>a;a++)o+=m(e[a],n,s,r);return o}switch(e.type){case t.POSITION:return"";case t.CLASS:if(!e.not)return i.rndChar(e.chars);for(;;){var h=s();if(-1===e.chars.indexOf(h))return h}case t.RANGE:for(var u=i.rndInt(e.min,e.max===1/0?e.min+n:e.max),o="",a=0;u>a;a++)o+=m(e.value,n,s,r);return o;case t.CLAUSE:if(e.options){var u=i.rndInt(0,e.options.length-1);return m(e.options[u],n,s,r)}var p=m(e.stack,n,s,r);return r.push(p),p;case t.REFERENCE:return r[e.value-1]}};RegExp.prototype.gen=function(){return void 0===this._randexp&&(this._randexp=v(this.source,this.ignoreCase,this.multiline),this._max=this._max||100,this._anyRndChar=this._anyRndChar||i.anyRndChar),m(this._randexp,this._max,this._anyRndChar,[])}}();var r,o,a;r={now:Date.now||function(){return(new Date).getTime()},isString:function(t){return"string"==typeof t},isUndefined:function(t){return void 0===t},isDefined:function(t){return!r.isUndefined(t)},isNumber:function(t){return"number"==typeof t},isObject:function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},isElement:function(t){return!(!t||1!==t.nodeType)},isFunction:function(t){return"function"==typeof t},isArray:function(t){return"[object Array]"==={}.toString.call(t)},last:function(t){return t[t.length-1]},noop:function(){},forEach:function(t,e,n){e=e.bind(n);var i,s;if(this.isArray(t))for(i=0,s=t.length;s>i;i+=1)e(t[i],i,t);else{var r=Object.keys(t);for(i=0,s=r.length;s>i;i+=1)e(t[r[i]],r[i],t)}return t},document:function(){return o.contextFrame?o.contextFrame.contentWindow.document:document},countDOM:function(t){return r.document().querySelectorAll(t).length},getInnerHTML:function(t){var e=r.document().querySelector(t);return e?e[e.value?"value":"innerHTML"]:"Error:No such HTMLElement."}},o={contextFrame:document.createElement("iframe"),defaultNextLoopDelay:3e3,readyTimeout:3e3,defaultClock:10,bootExceptionHandle:r.noop,triggerCallback:r.noop,runCallback:r.noop,runExceptionHandle:r.noop,successCallback:r.noop,readyCallback:r.noop,nextLoopCallback:r.noop,consoleFn:r.noop},a=function(t){return r.isString(t)?o[t]:r.isObject(t)?void r.forEach(t,function(t,e){this[e]=t},o):void 0},a.setContextFrame=function(t){trigger.setupIframe(t),o.contextFrame=t},e.prototype.field=function(t){return r.isArray(t)&&(this.$field=t),this.$options.field=this.$field,this.$field},e.prototype.assignment=function(t){return r.isArray(t)&&(this.$assignment=t),this.$options.assignment=this.$assignment,this.$assignment},e.prototype.load=function(t){var e,n=this.$assignment.length,i=this.getKeys(),s=(i.length,function(t){r.forEach(i,function(e,n){this[e.name]=t[n]},this)}),o=function(){r.forEach(i,function(t){this[t.name]=t.pattern.gen()},this)};for(this.$$buffer=[],e=0;n>e&&t>e;e+=1)this.$$buffer.push(new s(this.$assignment[e]));for(null;t>e;e+=1)this.$$buffer.push(new o);return this},e.prototype.getKeys=function(){var t=[];return r.forEach(this.$field,function(t){this.push({name:t.name,pattern:new RegExp(t.pattern)})},t),t},e.prototype.fetch=function(){return this.$$buffer.shift()},e.prototype.isFieldDefined=function(t){var e,n=this.$field.length;for(e=0;n>e;e+=1)if(this.$field[e].name===t)return!0;return!1};var c=function(t,e){function n(t,e){this.$case=e,this.$body=t.BODY,this.$line=t.LINE}if(!e){var i=h[t];if(!i)throw new Error("TYPE:"+t+" instruction is not existed.");return i}if(h[t])throw new Error("The instruction factory: TYPE="+t+" is existed.");return n.prototype.execute=e.operation,n.prototype.line=function(){return this.$line},n.prototype.body=function(t){return t?this.$body[t]:this.$body},n.prototype.assignCase=function(t){return this.$case=t,this},n.create=function(){return new n({BODY:e.bodyFactory.apply(null,arguments)})},n.$new=function(t,e){return new n(t,e)},h[t]=n,n},h=[],u=i.prototype;u.$$getConfig=function(t){return this.$$executionTree.config[t]},u.$$bootstrap=function(){var t=o.contextFrame.style,e=this.$$getConfig("screen");return this.$$currentLoop=0,this.hasDictionary()&&(this.$loopData=this.$dictionary.load(this.$$getConfig("times")).fetch()),e&&(t.height=e.height+"px",t.width=e.width+"px"),this.$setActiveTime().$setTempInstruction(c(p).create("main")).$$log.initialization(),this},u.$$exitCase=function(){return this.$setState("success").$$interrupt(),(o.successCallback||r.noop).call(this),this},u.$$interrupt=function(){return clearInterval(this.$$coreId),this},u.$$popInstruction=function(){var t=this.$$tempInstruction,e=this.$getCurrentBlock();return t?(this.$setTempInstruction(),t):e?(this.$$instructionBuffer=e.segment[e.counter++],this.$$instructionBuffer):c(l).create(!0).assignCase(this)},u.$$run=function(){try{this.$$popInstruction().execute(),o.runCallback.call(this)}catch(t){console.error(t),o.runExceptionHandle.call(this,t)}return this},u.$$core=function(){var t=this;return this.$$coreId=setInterval(function(){t["$$"+(r.now()>=t.$$activeTime?"run":"idleTask")]()},this.$$getConfig("clock")||o.defaultClock),this},u.hasDictionary=function(){return!!this.$dictionary},u.validateObjectList=function(t,e){return e.length?t?e.every(function(e){return null!==t[e]}):!1:!0},u.exportLog=function(t){return this.$$log["export2"+t]()},u.start=function(){var t=this.$$state;if("success"!==t&&"ready"!==t)throw new Error("Can not call play!");try{return this.$setState("running").$$bootstrap(),setTimeout(function(){this.$$core()}.bind(this),o.readyTimeout),this}catch(e){o.bootExceptionHandle(e)}},u.forceCofig=function(t){var e,n=this.$$executionTree.config;for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return this},u.suspend=function(){if("running"!==this.$$state)throw new Error("Can not call pause!");return this.$setState("pause").$$interrupt(),this},u.resume=function(){if("pause"!==this.$$state)throw new Error("Can not call resume!");return this.$setState("running").$$core(),this},u.stop=function(){var t=this.$$state;if("running"!==t&&"pause"!==t)throw new Error("Can not call stop!");return this.$setState("ready").$$interrupt(),this},u.debug=function(){var t=this.$$state;if("success"!==t&&"ready"!==t)throw new Error("Can not call play!");return this.$setState("debug").$$bootstrap(),this},u.dictionary=function(t){return t instanceof e&&(this.$dictionary=t),this.$dictionary},u.getLog=function(){return this.$$log},u.getCurrentStep=function(){return this.$$counter},u.getCurrentLoop=function(){return this.$$currentLoop},u.getCurrentLine=function(){return this.$$instructionBuffer.$getLine()},u.$setIdleTask=function(t){return this.$$idleTask=r.isFunction(t)?t:r.noop,this},u.$setActiveTime=function(t){return this.$$activeTime=r.now()+(t||0),this},u.$setTempInstruction=function(t){return this.$$tempInstruction=t?t.assignCase(this):void 0,this},u.$setState=function(t){return this.$$state=t,this},u.$pushBlock=function(t){return this.$$blockStack.push({counter:0,segment:t}),this},u.$pushScope=function(t){var e=this.$$blockStack;return this.$$scopeStack.push({blockIndex:e.length,vars:{}}),this.$pushBlock(this.$getProcess(t)),this},u.$popBlock=function(){return this.$$blockStack.pop(),this},u.$popScope=function(){var t=this.$$scopeStack.pop();return this.$$blockStack.length=t.blockIndex,this},u.$getCurrentBlock=function(){return r.last(this.$$blockStack)},u.$getCurrentScope=function(){return r.last(this.$$scopeStack)},u.$getProcess=function(t){return this.$$executionTree.process[t]},u.$exitLoop=function(){return this.$setActiveTime(this.$$getConfig("interval")||3e3),(this.$$currentLoop+=1)>=this.$$getConfig("times")?(this.$$exitCase(),this):(this.$setTempInstruction(c(p).create("main")),(o.nextLoopCallback||r.noop).call(this),this.hasDictionary()&&(this.$loopData=this.$dictionary.fetch()),this)},u.$runExp=function(t){return"function"==typeof t?t(this.$getCurrentScope().vars,this.$objectList,this.$loopData,r.countDOM,r.getInnerHTML):t},u.$pushLog=function(t,e){return this.getLog().log(t,e),this},u.$markLog=function(t,e){return this.getLog().markLog(t,e),this},u.$pushLogData=function(t,e){return this.getLog().data(t,e),this},u.$clearScope=function(){for(;this.$$scopeStack.length;)this.$popScope();return this};var p=0,f=1,l=2,d=16,v=17,m=18,g=19,y=20,$=21,x=32,b=33,k=1,w=0;return c(p,{operation:function(){var t=this.body("identifier");this.$case.$pushScope(t).$pushLog([p,t],this.line())},bodyFactory:function(t){return{identifier:t}}}),c(f,{operation:function(){this.$case.$pushLog([f]).$popScope()},bodyFactory:function(){return{}}}),c(l,{operation:function(){var t=this.body("isSuccess")?k:w,e=this.$case;e.$pushLog([l,t],this.line()).$markLog(t,e.getCurrentLoop()).$clearScope().$exitLoop()},bodyFactory:function(t){return{isSuccess:t}}}),c(d,{operation:function(){this.$case.$runExp(this.body("exp"))},bodyFactory:function(t){return{exp:t}}}),c(v,{operation:function(){var t=this.$case.$runExp(this.body("delay"));this.$case.$setActiveTime(t).$pushLog([v,t],this.line())},bodyFactory:function(t){return{delay:t}}}),c(m,{operation:function(){var t=this.$case.$runExp(this.body("object")),e={value:this.$case.$runExp(this.body("param"))},n=this.body("action"),i=r.document().querySelectorAll(t)[0];return i?(trigger(i).does(n,e),o.triggerCallback.call(this.$case,i),void this.$case.$pushLog([m,k,t,n,e],this.line())):(this.$case.$pushLog([m,w,t,n,e],this.line()).$setTempInstruction(c(l).create(!1).assignCase(this.$case)),void console.log("Can not find a DOM by cssPath: "+t))},bodyFactory:function(t,e,n){return{object:t,action:e,param:n}}}),c(g,{operation:function(){function t(){s.$runExp(n)&&s.$setIdleTask().$setTempInstruction().$setActiveTime().$pushLog([g,k],a.line()).$pushLogData(a.body("key"),r.now()-e)}var e=r.now(),n=this.body("exp"),i=this.body("timeout"),s=this.$case,a=this;s.$setTempInstruction(c(l).create(!1).assignCase(s)),i&&i>2*o.defaultClock&&s.$setActiveTime(i).$setIdleTask(t),s.$runExp(n)?(s.$setTempInstruction().$setActiveTime().$setIdleTask().$pushLog([g,k],this.line()),i&&s.$pushLogData(a.body("key"),0)):i||s.$pushLog([g,w],this.line())},bodyFactory:function(t,e,n){return{exp:t,timeout:e,key:n}}}),c(y,{operation:function(){var t=this.$case.$runExp(this.body("url"));o.contextFrame.src=t,this.$case.$pushLog([y,t],this.line())}}),c($,{operation:function(){o.contextFrame.src=r.document().location.href,this.$case.$pushLog([$],this.line())}}),c(x,{operation:function(){this.$case.$pushLog([x,this.$case.$runExp(this.body("msg"))])},bodyFactory:function(t){return{msg:t}}}),c(b,{operation:function(){var t=this.$case.$runExp(this.body("msg"));console.log(t),o.consoleFn(t)},bodyFactory:function(t){return{msg:t}}}),{Case:i,setup:a,Instruction:c,parse:LP.parse,Dictionary:e,init:t}});